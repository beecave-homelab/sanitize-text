<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sanitize Text - WebUI</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <header class="app-header">
        <div class="brand">
            <h1>Sanitize Text <span>WebUI</span></h1>
        </div>
        <button id="theme-toggle" class="theme-toggle" title="Toggle Dark Mode">ðŸŒ™</button>
    </header>

    <div class="main-layout">
        <!-- Left Panel: Input & Config -->
        <aside class="panel">
            <div class="flex-row justify-between">
                <div class="tabs">
                    <button id="tab-text" class="tab-btn active">Text Input</button>
                    <button id="tab-file" class="tab-btn">File Upload</button>
                </div>
                <div class="input-group">
                    <select id="locale-select" aria-label="Select Locale">
                        <option value="">Both (En + Nl)</option>
                        <option value="en_US">English (US)</option>
                        <option value="nl_NL">Dutch (NL)</option>
                    </select>
                </div>
            </div>

            <!-- Text Input Mode -->
            <div id="panel-text" style="display: flex; flex-direction: column; flex: 1;">
                <textarea id="input-text" placeholder="Paste text to scrub here..."></textarea>
            </div>

            <!-- File Input Mode -->
            <div id="panel-file" style="display: none; flex-direction: column; flex: 1;">
                <div id="dropzone" class="dropzone">
                    <div class="icon">ðŸ“„</div>
                    <p>Drop file here or click to browse</p>
                    <span class="text-muted" style="font-size: 0.8rem; margin-top: 0.5rem;">
                        Supports .txt, .pdf, .docx, .png, .jpg
                    </span>
                    <input type="file" id="file-input" hidden>
                    <div id="file-info" class="file-info"></div>
                </div>
            </div>

            <!-- Settings -->
            <details>
                <summary>Configuration</summary>
                <div class="details-content flex-col">
                    
                    <!-- Switches -->
                    <div class="flex-row" style="gap: 1rem; margin-bottom: 0.5rem;">
                        <label class="checkbox-label">
                            <input type="checkbox" id="cleanup-check" checked> Cleanup Output
                        </label>
                        <label class="checkbox-label">
                            <input type="checkbox" id="verbose-check"> Verbose Logging
                        </label>
                    </div>

                    <!-- Custom Pattern -->
                    <div class="input-group">
                        <label for="custom-text">Custom Pattern (Optional)</label>
                        <input type="text" id="custom-text" placeholder="e.g. CompanyName">
                    </div>

                    <!-- Detectors -->
                    <div class="detector-section">
                        <h2>Universal Detectors</h2>
                        <div class="checkbox-grid">
                            {% for key, desc in generic_detectors.items() %}
                            <label class="checkbox-label" title="{{ desc }}">
                                <input type="checkbox" name="detector" value="{{ key }}" checked>
                                {{ key.replace('_', ' ').title() }}
                            </label>
                            {% endfor %}
                        </div>
                    </div>

                    <div id="detectors-en" class="detector-section" style="margin-top: 1rem;">
                        <h2>English Detectors</h2>
                        <div class="checkbox-grid">
                            {% for key, desc in english_detectors.items() %}
                            <label class="checkbox-label" title="{{ desc }}">
                                <input type="checkbox" name="detector" value="en:{{ key }}" {% if key != 'date_of_birth' %}checked{% endif %}>
                                {{ key.replace('_', ' ').title() }}
                            </label>
                            {% endfor %}
                        </div>
                    </div>

                    <div id="detectors-nl" class="detector-section" style="margin-top: 1rem;">
                        <h2>Dutch Detectors</h2>
                        <div class="checkbox-grid">
                            {% for key, desc in dutch_detectors.items() %}
                            <label class="checkbox-label" title="{{ desc }}">
                                <input type="checkbox" name="detector" value="nl:{{ key }}" checked>
                                {{ key.replace('_', ' ').title() }}
                            </label>
                            {% endfor %}
                        </div>
                    </div>

                    {% if not spacy_available %}
                    <div style="margin-top: 0.5rem; font-size: 0.8rem; color: orange;">
                        âš  Install <code>sanitize-text[spacy]</code> for improved entity detection.
                    </div>
                    {% endif %}

                    <!-- Output Format Settings -->
                    <div style="margin-top: 1rem; padding-top: 1rem; border-top: 1px solid var(--border);">
                        <h2>Export Settings</h2>
                        <div class="flex-row" style="flex-wrap: wrap;">
                            <div class="input-group">
                                <label for="output-format">Format</label>
                                <select id="output-format">
                                    <option value="txt">TXT</option>
                                    <option value="docx">DOCX</option>
                                    <option value="pdf">PDF</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="pdf-mode">PDF Mode</label>
                                <select id="pdf-mode">
                                    <option value="pre">Preformatted</option>
                                    <option value="para">Paragraph</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="font-size">Font Size</label>
                                <input type="number" id="font-size" value="11" min="6" max="72" style="width: 80px;">
                            </div>
                            <div class="input-group">
                                <label for="pdf-backend">PDF Backend</label>
                                <select id="pdf-backend">
                                    <option value="pymupdf4llm" selected>PyMuPDF4LLM (default)</option>
                                    <option value="markitdown">MarkItDown</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </details>

            <button id="scrub-btn" class="btn btn-primary w-full" style="margin-top: auto;">Scrub Text</button>
        </aside>

        <!-- Right Panel: Output -->
        <main class="panel">
            <div class="flex-row justify-between">
                <h2>Output</h2>
                <div class="flex-row">
                    <span id="result-meta" style="font-size: 0.8rem; color: var(--text-muted);"></span>
                    <button id="copy-btn" class="btn btn-ghost">Copy</button>
                    <button id="download-btn" class="btn btn-secondary">Download</button>
                </div>
            </div>

            <textarea id="output-text" readonly placeholder="Scrubbed text will appear here..."></textarea>

            <div class="cli-preview">
                <div class="flex-row justify-between" style="margin-bottom: 0.5rem;">
                    <h2>CLI Equivalent</h2>
                    <button id="cli-copy" class="btn btn-ghost" style="padding: 0;">Copy</button>
                </div>
                <div id="cli-code" class="cli-code">sanitize-text -t &lt;text&gt;</div>
            </div>
        </main>
    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
